{"version":3,"sources":["../node_modules/peerjs/dist sync","video.js","App.js","reportWebVitals.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","Cus_video","stream","domvideo","useRef","useEffect","current","srcObject","ref","width","autoPlay","display","theme","createMuiTheme","typography","fontFamily","join","App","useState","Peer","randomstring","generate","initiator","trickle","secure","peer","peerID","setpeerID","conn","setconn","peerConnectID","setpeerConnectID","prevpeerConnectID","setprevpeerConnectID","optional","setoptional","messages","setmessages","clientVideo","objectVideo","setobjectVideo","listFile","setlistFile","loadding","setloadding","on","err","failedtoJoinServer","console","log","reconnect","data","send","type","from","undefined","prev","msg","filename","blob","Blob","file","data_type","url","URL","createObjectURL","name","success","call","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","oGetUserMedia","video","window","innerWidth","height","innerHeight","audio","answer","remoteStream","prevStream","push","pp","filter","ele","ind","findIndex","elem","getTracks","forEach","track","stop","error","a","setInterval","destroy","disconnected","location","reload","connectPeer","option","getAudioTracks","getVideoTracks","fail","connect","warn","typemsg","settypemsg","setmyfile","buttonUpload","setbuttonUpload","Container","maxWidth","Card","CardContent","Tooltip","title","Alert","severity","onClick","clipboard","writeText","CardActions","style","justifyContent","Button","variant","size","justify","Grid","container","xs","p","Item","TextField","label","defaultValue","onChange","target","value","disabled","mt","map","Typography","color","onKeyDown","key","length","myid","message","marginTop","accept","files","onChangeHandler","onClickHandler","LinearProgress","href","open","muted","i","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","browser","detect","table","ReactDOM","render","StrictMode","textAlign","path","exact","component","document","getElementById"],"mappings":"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","file":"static/js/main.6ee53657.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 272;","import React,{useRef,useEffect} from 'react';\r\n\r\nconst Cus_video = ({stream}) => {\r\n    const domvideo = useRef()\r\n    useEffect(() => {\r\n        domvideo.current.srcObject = stream\r\n    }, [])\r\n    return (\r\n        <video id={stream.id} ref={domvideo} width=\"50%\" autoPlay display=\"flex\"></video>\r\n    );\r\n}\r\n\r\nexport default Cus_video;\r\n","import React, { useState, useRef, useEffect } from \"react\";\r\nimport {\r\n  Button,\r\n  Container,\r\n  Typography,\r\n  createMuiTheme,\r\n  CardContent,\r\n  CardActions,\r\n  Card,\r\n  TextField,\r\n  Grid,\r\n  Tooltip,\r\n  IconButton,\r\n  palette,\r\n  LinearProgress ,\r\n} from \"@material-ui/core\";\r\nimport {Alert} from '@material-ui/lab/';\r\nimport { spacing ,positions } from '@material-ui/system';\r\nimport randomstring from 'randomstring'\r\nimport Peer from \"peerjs\";\r\nimport Cus_video from './video'\r\nconst theme = createMuiTheme({\r\n  typography: {\r\n    fontFamily: [\r\n      \"-apple-system\",\r\n      \"BlinkMacSystemFont\",\r\n      '\"Segoe UI\"',\r\n      \"Roboto\",\r\n      '\"Helvetica Neue\"',\r\n      \"Arial\",\r\n      \"sans-serif\",\r\n      '\"Apple Color Emoji\"',\r\n      '\"Segoe UI Emoji\"',\r\n      '\"Segoe UI Symbol\"',\r\n    ].join(\",\"),\r\n  },\r\n});\r\n// 'iceServers': [ { url: 'stun:stun.l.google.com:19302' }, { url: 'stun:stun1.l.google.com:19302' }, ],\r\nconst App = () => {\r\n  const [peer, setpeer] = useState(new Peer(randomstring.generate(2)+'-CS',{\r\n    initiator: true,\r\n    trickle: false,\r\n    secure: true,\r\n  }));\r\n  const [peerID, setpeerID] = useState(peer.id);\r\n  const [conn, setconn] = useState();\r\n  const [peerConnectID, setpeerConnectID] = useState();\r\n  const [prevpeerConnectID, setprevpeerConnectID] = useState(\"\");\r\n  const [optional, setoptional] = useState();\r\n  const [messages, setmessages] = useState([]);\r\n  const clientVideo = useRef();\r\n  const [objectVideo, setobjectVideo] = useState([]);\r\n  const [listFile, setlistFile] = useState([]);\r\n\r\n  const [loadding, setloadding] = useState(false);\r\n\r\n  useEffect(() => {\r\n\r\n    peer.on(\"open\", (id) => {\r\n      setpeerID(id)\r\n    });\r\n    peer.on(\"error\", (err) => {\r\n      setloadding(false)\r\n      failedtoJoinServer(err)\r\n    });\r\n    peer.on(\"disconnected\",()=>{\r\n      console.log(`peer id ${peer.id} disconnected`)\r\n      reconnect()\r\n    })\r\n    peer.on(\"connection\", (conn) => {\r\n      setloadding(true)\r\n      setconn(conn);\r\n      console.log(\":N:--->> peer connection\");\r\n      console.log(conn);\r\n      conn.on(\"open\", () => {\r\n        \r\n        setloadding(false)\r\n        const data = `${peer.id} is Joined`;\r\n        conn.send({ type: \"chat\", data: data, from: peer.id });\r\n      });\r\n      conn.on(\"data\", (data) => {\r\n        setloadding(false)\r\n        if (peerConnectID === undefined){\r\n            setprevpeerConnectID(data.from)\r\n           setpeerConnectID(data.from);\r\n          }\r\n        if (data.type === \"disconnect\"){\r\n          // console.warn(`${peerConnectID} is disconnected`)\r\n          console.log(`${peerConnectID} is disconnected`)\r\n          reconnect()\r\n        }\r\n        if (data.type === \"chat\") {\r\n          setmessages((prev) => [...prev, { from: data.from, msg: data.data }]);\r\n          setoptional(2);\r\n        } else if (data.type === \"file\") {\r\n          setoptional(3);\r\n          console.log(data);\r\n          if (data.filename) {\r\n            const blob = new Blob([data.file], {type: data.data_type});\r\n            const url = URL.createObjectURL(blob);\r\n            setlistFile(prev=>[...prev,{name:data.filename,url:url}]);\r\n            // window.open(url, \"_blank\");\r\n            if (url) {\r\n              conn.send({ type: \"connect\", success: true });\r\n            }\r\n          }\r\n        }\r\n        else if (data.type === \"connect\" && data.success) {\r\n          console.log(\"success\");\r\n          conn.send({ type: \"connect\", success: true });\r\n        }\r\n      });\r\n\r\n      conn.on(\"error\", (err) => {\r\n        setloadding(false)\r\n        failedtoJoinServer(err)\r\n      });\r\n    });\r\n\r\n    peer.on(\"call\", (call) => {\r\n      \r\n      setloadding(true)\r\n      navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia || navigator.mozGetUserMedia.getUserMedia;\r\n        \r\n        \r\n      navigator.getUserMedia (\r\n        { video: { width: window.innerWidth / 2, height: window.innerHeight / 2 }, audio: true },\r\n        (stream) => {\r\n          clientVideo.current.srcObject = stream;\r\n          call.answer(stream); \r\n          call.on(\"stream\", (remoteStream) => {\r\n            setprevpeerConnectID(call.peer)\r\n            setloadding(false)\r\n            prevStream.push(remoteStream)\r\n            let pp = prevStream.filter( (ele, ind) => ind === prevStream.findIndex( elem =>  elem.id === ele.id))\r\n            setobjectVideo(pp)\r\n            setconn(call);\r\n          });\r\n          call.on(\"error\", (err) => {\r\n            setloadding(false)\r\n            failedtoJoinServer(err)\r\n            stream.getTracks().forEach((track) => track.stop());\r\n          });\r\n        },\r\n        (err) => {\r\n          setloadding(false)\r\n          console.error(\"Failed to get local stream\", err);\r\n        }\r\n      );\r\n    });\r\n  }, []);\r\n  let prevStream = []\r\n\r\n  const failedtoJoinServer = async (err) =>{\r\n    if(err.type === 'unavailable-id'||err.type === 'peer-unavailable'){ \r\n      console.log(err); \r\n      setInterval(() => {\r\n        peer.destroy()\r\n      }, 2345);\r\n      if(peer.disconnected)\r\n        window.location.reload()\r\n    }else{\r\n      console.error(err)\r\n    }\r\n  }\r\n  \r\n  const reconnect = async () => {\r\n    console.log('reconnect')\r\n    window.location.reload()\r\n  };\r\n  const openWebCam = () => {\r\n    setloadding(true)\r\n    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia || navigator.mozGetUserMedia.getUserMedia;\r\n\r\n        \r\n    navigator.getUserMedia (\r\n      { video: { width: window.innerWidth / 2, height: window.innerHeight / 2 }, audio: true },\r\n      (stream) => {\r\n        \r\n        const call = peer.call(peerConnectID, stream);\r\n        console.log(` caller => `,call,stream)\r\n        clientVideo.current.srcObject = stream;\r\n        call.on(\"stream\", (remoteStream) => {\r\n          setloadding(false)\r\n          prevStream.push(remoteStream)\r\n          let pp = prevStream.filter( (ele, ind) => ind === prevStream.findIndex( elem =>  elem.id === ele.id))\r\n          setobjectVideo(pp)\r\n          setconn(call);\r\n        });\r\n        call.on(\"error\", (err) => {\r\n          setloadding(false)\r\n          failedtoJoinServer(err)\r\n          stream.getTracks().forEach((track) => track.stop());\r\n          stream.getAudioTracks()[0].stop();\r\n          stream.getVideoTracks()[0].stop();\r\n        });\r\n      },\r\n      (fail) => {console.log(`ไม่สามารถเปิดกล้องได้`); console.log(fail);setloadding(false)}\r\n    );\r\n  };\r\n  const connectPeer = (option) => {\r\n    setloadding(true)\r\n    if (option === 1) {\r\n      openWebCam();\r\n    } else if (option === 2) {\r\n      const conn =  peer.connect(peerConnectID);\r\n      console.log(\"<<---:E: peer connection\");\r\n      console.log(conn);\r\n      \r\n      conn.on(\"open\", () => {\r\n        \r\n        setloadding(false)\r\n        const data = `${peer.id} is Joined`;\r\n        conn.send({ type: \"chat\", data: data, from: peer.id });\r\n      });\r\n      setconn(conn);\r\n      conn.on(\"data\", (data) => {\r\n        setloadding(false)\r\n        if (peerConnectID === undefined) {setpeerConnectID(data.from);}\r\n        if (data.type === \"chat\") {\r\n          setmessages((prev) => [...prev, { from: data.from, msg: data.data }]);\r\n          setoptional(2);\r\n        } else if (data.type === \"file\") {\r\n          setoptional(3);\r\n          console.log(data);\r\n          if (data.filename) {\r\n            const blob = new Blob([data.file], {type: data.type});\r\n            const url = URL.createObjectURL(blob);\r\n            setlistFile(prev=>[...prev,{name:data.filename,url:url}]);\r\n            // window.open(url, \"_blank\");\r\n            if (url) {\r\n              conn.send({ type: \"connect\", success: true });\r\n            }\r\n          }\r\n        }\r\n        if (data.type === \"disconnect\"){\r\n          \r\n          // console.warn(`${peerConnectID} is disconnected`)\r\n          console.log(`${peerConnectID} is disconnected`)\r\n          setloadding(false)\r\n          reconnect()\r\n        }\r\n      });\r\n\r\n      conn.on(\"error\", (err) => {\r\n        setloadding(false)\r\n        failedtoJoinServer(err)\r\n      });\r\n    } else if (option === 3) {\r\n      const conn = peer.connect(peerConnectID);\r\n      console.log(\"<<---:E: peer connection\");\r\n      console.log(conn);\r\n      conn.on(\"open\", () => {\r\n        setloadding(false)\r\n        const data = `${peer.id} is Joined`;\r\n        conn.send({ type: \"file\", data: data, from: peer.id });\r\n      });\r\n      setconn(conn);\r\n      conn.on(\"data\", (data) => {\r\n        setloadding(false)\r\n       if (data.type === \"file\") {\r\n        setoptional(3);\r\n        console.log(data);\r\n        if (data.filename) {\r\n          const blob = new Blob([data.file], {type: data.data_type});\r\n          const url = URL.createObjectURL(blob);\r\n          setlistFile(prev=>[...prev,{name:data.filename,url:url}]);\r\n          // window.open(url, \"_blank\");\r\n          if (url) {\r\n            conn.send({ type: \"connect\", success: true });\r\n          }\r\n        }\r\n      }\r\n        if (data.type === \"disconnect\"){\r\n          // console.warn(`${peerConnectID} is disconnected`)\r\n          console.log(`${peerConnectID} is disconnected`)\r\n          conn.send({ type: \"disconnect\", from: peer.id });\r\n        }\r\n      });\r\n\r\n      conn.on(\"error\", (err) => {\r\n        setloadding(false)\r\n        failedtoJoinServer(err)\r\n      });\r\n      setoptional(3);\r\n    } else {\r\n      setloadding(false)\r\n      console.warn(\"fail to connect\");\r\n      \r\n    }\r\n  };\r\n  const [typemsg, settypemsg] = useState(\"\");\r\n\r\n  const chat = () => {\r\n    return (\r\n      <>\r\n        {messages.map((data, ind) => (\r\n          <Grid key={ind + data.from + data.msg} Item={true} xs={12}>\r\n          <CardActions style={{ width: '90%' ,justifyContent: data.from === peer.id ? \"flex-end\" : \"flex-start\" }}>\r\n              <Typography\r\n                color={data.from === peer.id ? \"primary\" : \"textPrimary\"}\r\n              >\r\n                {data.msg}\r\n              </Typography>\r\n            </CardActions>\r\n          </Grid>\r\n        ))}\r\n        <TextField\r\n          type=\"text\"\r\n          label=\"ใส่ข้อความ\"\r\n          defaultValue={typemsg}\r\n          onChange={(e) => settypemsg(e.target.value)}\r\n          onKeyDown={(e) => {\r\n            if (e.key == \"Enter\" && typemsg.length > 0) {\r\n              const msg = typemsg;\r\n              const myid = peer.id;\r\n              try{\r\n                conn.send({ type: \"chat\", data: msg, from: myid });\r\n              }catch(e){setloadding(false);console.warn(e.message); reconnect()}\r\n              setmessages((prev) => [...prev, { from: myid, msg: typemsg }]);\r\n              e.target.value = \"\";\r\n              settypemsg(\"\")\r\n            }\r\n          }}\r\n        />\r\n      </>\r\n    );\r\n  };\r\n  const [file, setmyfile] = useState();\r\n  const [buttonUpload, setbuttonUpload] = useState(true);\r\n\r\n  const upload = () => {\r\n    const onChangeHandler = (e) => {\r\n      setmyfile(e.target.files[0]);\r\n\r\n      setbuttonUpload(false);\r\n    };\r\n    const onClickHandler = () => {\r\n      const blob = new Blob([file], {type: file.type});\r\n        conn.send({\r\n          type: 'file',\r\n          data_type:file.type,\r\n          file: blob,\r\n          filename: file.name,\r\n          from: peer.id,\r\n        });\r\n        console.log('send ',file.name)\r\n      //\r\n    };\r\n    return (\r\n      <>\r\n        <input\r\n        style={{marginTop:\"3%\"}}\r\n          type=\"file\"\r\n          accept=\"*\"\r\n          onChange={(e) => onChangeHandler(e)}\r\n        />\r\n        <Button\r\n          variant=\"outlined\"\r\n          color=\"primary\"\r\n          style={{marginTop:\"3%\"}}\r\n          disabled={buttonUpload}\r\n          onClick={() => onClickHandler()}\r\n        >\r\n          Upload\r\n        </Button>\r\n      </>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {peer ? (\r\n        <>\r\n          <Container theme={theme} maxWidth=\"sm\">\r\n            <Card>\r\n              <CardContent display=\"flex\">\r\n                    <Tooltip title=\"กดเพื่อคัดลอก\">\r\n                      <Alert\r\n                        severity=\"success\"\r\n                        onClick={() => {\r\n                          try {\r\n                            navigator.clipboard.writeText(peerID);\r\n                          } catch (e) {\r\n                            console.log(\r\n                              \"ERROR : ไม่สามารถใช้งานคลิกเพื่อคัดลอกได้ \\n ให้ผู้ใช้คลุมเพื่อคัดลอกแทน \\n\"\r\n                            );\r\n                          }\r\n                        }}\r\n                      >\r\n                        ID : {peerID}{\" \"}  \r\n                      </Alert>\r\n                    </Tooltip>\r\n\r\n              </CardContent>\r\n              {conn ? (\r\n                <CardActions style={{ width: '90%', justifyContent: 'flex-end'  }}>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    size=\"small\"\r\n                    justify=\"space-between\" \r\n                    onClick={() => {try{conn.send({ type: \"disconnect\", success: \"bye\" })}catch(e){};reconnect()}}\r\n                  >\r\n                    ย้อนกลับ\r\n                  </Button>\r\n                  </CardActions>\r\n\r\n              ) : (\r\n                <>\r\n                  <hr />\r\n                  <Grid container xs={12} p=\"2\">\r\n                    <Grid Item={true} xs={10}>\r\n                      <TextField\r\n                        type=\"text\"\r\n                        label=\"ID เพื่อน \"\r\n                        defaultValue={prevpeerConnectID}\r\n                        onChange={(e) =>{ setpeerConnectID(e.target.value);setprevpeerConnectID(e.target.value)}}\r\n                      />\r\n                    </Grid>\r\n                    <Grid Item={true} xs={3}>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        size=\"small\"\r\n                        onClick={() => {\r\n                          console.log('open camera')\r\n                          connectPeer(1);\r\n                        }}\r\n                        disabled={!peerConnectID && !prevpeerConnectID ? true : false}\r\n                      >\r\n                        กล้อง\r\n                      </Button>\r\n                    </Grid>\r\n                    <Grid Item={true} xs={3}>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        size=\"small\"\r\n                        onClick={() => connectPeer(2)}\r\n                        disabled={!peerConnectID && !prevpeerConnectID ? true : false}\r\n                      >\r\n                        แชท\r\n                      </Button>\r\n                    </Grid>\r\n                    <Grid Item={true} xs={3}>\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        size=\"small\"\r\n                        onClick={() => connectPeer(3)}\r\n                        disabled={!peerConnectID && !prevpeerConnectID ? true : false}\r\n                      >\r\n                        ไฟล์\r\n                      </Button>\r\n                    </Grid>\r\n                  </Grid>\r\n                </>\r\n              )}\r\n            </Card>\r\n          </Container>\r\n          <Container theme={theme} maxWidth=\"sm\" mt={2}>\r\n            <Grid container justify=\"center\">\r\n              {optional === 2 ? (\r\n                <>{chat()}</>\r\n              ) : optional === 3 && conn? (\r\n                <>{upload()}</>\r\n              ) : (\r\n                <></>\r\n              )}\r\n            </Grid>\r\n          </Container>\r\n          {loadding ? <LinearProgress style={{marginTop:'1%'}} />: <> </> }\r\n          \r\n          <Container theme={theme} justify=\"center\" maxWidth=\"sm\" mt={2}>\r\n          {listFile && listFile.map((file,ind)=>\r\n              <p key={ind}>\r\n                <a href=\"#\" onClick={()=>window.open(file.url, \"_blank\")}> {file.name}</a>\r\n              </p>\r\n            )}\r\n          </Container>\r\n          <Grid container justify=\"center\">\r\n            {/* setlistFile(prev=>[...prev,{name:data.filename,url:url}]); */}\r\n            \r\n            <video\r\n              display=\"flex\"\r\n              ref={clientVideo}\r\n              width=\"50%\"\r\n              autoPlay\r\n              muted\r\n            />\r\n            {objectVideo && objectVideo.map((stream,i)=><Cus_video key={i} stream={stream} />)}\r\n           </Grid>\r\n        </>\r\n      ) : (\r\n        <></>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport {detect } from 'detect-browser'\r\nimport {Alert} from '@material-ui/lab/';\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n} from \"react-router-dom\";\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nconst browser = detect();\r\nconsole.table(browser)\r\n\r\nconst app = () => <App  />\r\nReactDOM.render(\r\n  \r\n  <React.StrictMode>\r\n  <Router >\r\n      <Switch>\r\n      {browser.name === 'edge-chromium' ? <Alert severity=\"error\"  style={{textAlign:'center'}}>ใช้ไม่ได้นะ ให้ไปใช้ firefox หรือ chrome แทน </Alert> :<Route path=\"/\" exact component={app} /> }\r\n      </Switch>\r\n  </Router>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}